#!/bin/bash

declare check_kernel

echo
echo "your dir : $PWD"

echo "what do you want?"
echo "1.generate 2.clean"
echo ""
read -p "you selected : " input

check_kernel="`pwd | grep kernel`"
if [ -e "$check_kernel" ]
then
    echo "it is kernel dir"
    make ARCH=arm tags cscope
    exit 0
fi

if [ "$input" -eq 1 ]; then

    find . \! -type l -a -name '*.[chS]' -o -name '*.mk' -o -name '*.cc' -o -name '*.hpp' -o -name '*.cpp*' -o -name 'Makefile' >cscope.files
    #cscope -bqkv -i cscope.files
    #cscope -b -k
    cscope -b -q -k -R -v -i cscope.files
    ctags -R --c++-kinds=+p --fields=+iaS --extra=+q
    gtags

    if [ ! -e .git ]; then
        #git init .
        touch .projectile
    fi  

elif [ "$input" -eq 2 ]; then

    rm -rf cscope*
    rm -rf *tags*
    rm -rf GPATH GRTAGS GSYMS GTAGS

    #if git log 2>&1 | grep fatal; then
    #    rm -rf .git
    #fi  

    if [ -e .projectile ]; then
        rm .projectile
    fi  

else
       echo do nothing
fi
